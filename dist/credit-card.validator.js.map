{"version":3,"file":"credit-card.validator.js","sourceRoot":"","sources":["../src/credit-card.validator.ts"],"names":[],"mappings":"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","sourcesContent":["import { AbstractControl, Validators } from '@angular/forms';\r\nimport { CreditCard } from './shared/credit-card';\r\n\r\nexport class CreditCardValidator {\r\n  static validateCCNumber(control: AbstractControl): any {\r\n    if (Validators.required(control) !== undefined && Validators.required(control) !== null) {\r\n      return {'ccNumber': false};\r\n    }\r\n\r\n    let num = control.value.toString().replace(/\\s+|-/g, '');\r\n\r\n    if (!/^\\d+$/.test(num)) {\r\n      return {'ccNumber': false};\r\n    }\r\n\r\n    let card = CreditCard.cardFromNumber(num);\r\n\r\n    if (!card) {\r\n      return {'ccNumber': false};\r\n    }\r\n\r\n    if (card.length.includes(num.length) && (card.luhn === false || CreditCard.luhnCheck(num))) {\r\n      return null;\r\n    }\r\n\r\n    return {'ccNumber': false};\r\n  }\r\n\r\n  static validateExpDate(control: AbstractControl): any {\r\n    if (Validators.required(control) !== undefined && Validators.required(control) !== null) {\r\n      return {'expDate': false };\r\n    }\r\n\r\n    if (typeof control.value !== 'undefined' && control.value.length >= 7) {\r\n      let [month, year] = control.value.split(/[\\s\\/]+/, 2),\r\n          prefix;\r\n\r\n      if ((year != null ? year.length : void 0) === 2 && /^\\d+$/.test(year)) {\r\n        prefix = new Date().getFullYear();\r\n        prefix = prefix.toString().slice(0, 2);\r\n        year = prefix + year;\r\n      }\r\n      month = parseInt(month, 10).toString();\r\n      year  = parseInt(year, 10).toString();\r\n\r\n      if (/^\\d+$/.test(month) && /^\\d+$/.test(year) && (month >= 1 && month <= 12)) {\r\n        let currentTime, expiry;\r\n        expiry = new Date(year, month);\r\n        currentTime = new Date();\r\n        expiry.setMonth(expiry.getMonth() - 1);\r\n        expiry.setMonth(expiry.getMonth() + 1, 1);\r\n\r\n        if (expiry > currentTime) {\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {'expDate': false };\r\n\r\n  }\r\n}\r\n"]}